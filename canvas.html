<meta name=viewport content="width=device-width"><style>*{margin:0;padding:0;user-select:none;text-align:center;font-weight:bolder}canvas,img{display:block;border:solid;margin:1rem auto 0}canvas{cursor:crosshair}button{cursor:pointer;padding:.5rem}[type=checkbox]{width:5vmin;height:5vmin;transform:translateY(40%)}p{position:absolute;display:none;top:50%;text-align:center;width:100%}div{display:none;margin:1rem;font-size:5vmin}</style><button style=margin-right:1rem>导出为GIF</button>画板设置：<input type=checkbox><button style=margin-left:1rem onclick=location.reload()>重置画布</button><div><b>画笔粗细：</b><input type=range min=1 max=10 value=6>&nbsp;<span></span>&emsp;<b>画笔颜色：</b><input type=color>&emsp;<b>画布颜色：</b><input type=color>&emsp;<b>GIF品质：</b><input type=range min=1 max=5 value=4>&nbsp;<span></span></div><canvas></canvas><img><p>wait…</p><script src=https://cdn.bootcdn.net/ajax/libs/gif.js/0.2.0/gif.js></script><script>window.onload=(()=>{if(~navigator.userAgent.indexOf("Android")){let e=document.querySelectorAll("b"),t=document.querySelector("div");t.insertBefore(document.createElement("br"),e[1]),t.insertBefore(document.createElement("br"),e[3]),t.setAttribute("style","text-align:left")}document.querySelector("input").onchange=function(){this.checked?(document.querySelector("div").style.display="block",document.querySelector("button").setAttribute("disabled","")):(document.querySelector("div").style.display="none",document.querySelector("button").removeAttribute("disabled"))},document.querySelector("span").innerHTML="6",document.querySelector("span:nth-of-type(2)").innerHTML="4",document.querySelector("[type=color]:nth-of-type(3)").value="#ffffff";const e=new GIF({workers:20,quality:1}),t=document.querySelector("canvas"),o=t.getContext("2d"),n=document.querySelector("p");t.width=window.innerWidth-20,t.height=window.innerHeight-100,o.fillStyle="white",o.fillRect(0,0,t.width,t.height),o.lineWidth=6,document.querySelector("[type=color]").onchange=function(){o.strokeStyle=this.value},document.querySelector("[type=range]").onchange=function(){o.lineWidth=this.nextSibling.nextSibling.innerHTML=this.value};let l=200;document.querySelector("[type=range]:nth-of-type(4)").onchange=function(){this.nextSibling.nextSibling.innerHTML=this.value,l=100*(6-this.value),console.log(l)},document.querySelector("[type=color]:nth-of-type(3)").onchange=function(){o.fillStyle=this.value,o.fillRect(0,0,t.width,t.height)};const i=o=>{let n=new Image;n.src=t.toDataURL("image/png"),n.onload=(()=>{e.addFrame(n,{delay:100})}),gi=setInterval(()=>{let o=new Image;o.src=t.toDataURL("image/png"),o.onload=(()=>{e.addFrame(o,{delay:100})})},o)},r=()=>{setTimeout(()=>{clearInterval(gi)},100)};t.onmousedown=(e=>{o.beginPath(),o.moveTo(e.offsetX,e.offsetY),i(l),t.onmousemove=(e=>{o.lineTo(e.offsetX,e.offsetY),o.stroke()}),document.onmouseup=(()=>{t.onmousemove=null,r()})}),t.ontouchstart=(e=>{i(l);let n=e.targetTouches[0];o.moveTo(n.clientX-t.offsetLeft,n.clientY-t.offsetTop),t.ontouchmove=(e=>{let n=e.targetTouches[0];o.lineTo(n.clientX-t.offsetLeft,n.clientY-t.offsetTop),o.stroke()}),t.ontouchend=(()=>{r()})}),document.querySelector("button").onclick=function(){this.setAttribute("disabled",""),n.style.display="block";let t=1;setInterval(()=>{n.innerHTML=`wait……${t++}s`},1e3),e.on("finished",e=>{let t=document.createElement("a");t.href=document.querySelector("img").src=URL.createObjectURL(e),t.download="gif.gif",t.click(),window.scrollTo(0,1e4),setTimeout(()=>{window.scrollTo(0,1e4),n.style.display="none",this.removeAttribute("disabled")},1e3)}),e.render()}});</script>